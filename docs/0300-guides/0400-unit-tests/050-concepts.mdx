---
title: "Unit Testing Data Pipelines"
description: "Understand unit testing concepts for data pipelines in Starlake, using DuckDB for fast local testing without cloud access or service accounts."
keywords: [starlake, unit testing, data pipeline testing, duckdb, sql transpilation, data quality]
---

import Head from '@docusaurus/Head';

<Head>
  <script type="application/ld+json">
    {JSON.stringify({
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Why does Starlake use DuckDB for unit testing?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Starlake uses DuckDB because it is a fast, in-memory SQL database that runs locally without requiring cloud access or service accounts. This eliminates data access costs, provides fast feedback, and allows deterministic, repeatable tests."
          }
        },
        {
          "@type": "Question",
          "name": "How do Starlake unit tests work locally?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Starlake transpiles your target data warehouse SQL dialect to DuckDB-compatible SQL. This lets you run your production load and transform logic on a local DuckDB instance, comparing actual results against expected data defined in JSON files."
          }
        },
        {
          "@type": "Question",
          "name": "Can I run Starlake unit tests in my CI pipeline?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, since Starlake unit tests run on DuckDB locally, they can be executed in any CI environment without needing a service account or access to the target data warehouse. This makes them ideal for automated testing before deployment."
          }
        },
        {
          "@type": "Question",
          "name": "What can I test with Starlake unit tests?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can test both data loading and data transformations. For load tests, you provide sample input files and expected output data. For transform tests, you provide sample source data and verify the SQL transformation produces the expected results."
          }
        }
      ]
    })}
  </script>
</Head>

# Unit Testing Data Pipelines

Unit tests are a critical part of the software development process.
They help ensure that the code works as expected and that changes to the code do not introduce bugs.
In data engineering, unit tests are used to validate the correctness of data pipelines.
Unit tests can be used to test the correctness of the data transformations, the data loading process, and the data quality.

The main issues in testing data engineering pipelines on the target datawarehouse are:
- Data access costs
- Shared database unsuitable for unit tests
- Requires a service account for your C.I..
- Slow feedback loop
- Hard to test the code in a repeatable way

To address these issues, Starlake transpiles your SQL dialect to the  in-memory datawarehouse DuckDB.
This allows you to run your unit tests on your local machine without the need for a service account or access to the target datawarehouse.
This also allows you to run your unit tests in a repeatable way, ensuring that your tests are deterministic.

![](/img/starlake-unit-tests.png)

## Frequently Asked Questions

### Why does Starlake use DuckDB for unit testing?
Starlake uses DuckDB because it is a fast, in-memory SQL database that runs locally without requiring cloud access or service accounts. This eliminates data access costs, provides fast feedback, and allows deterministic, repeatable tests.

### How do Starlake unit tests work locally?
Starlake transpiles your target data warehouse SQL dialect to DuckDB-compatible SQL. This lets you run your production load and transform logic on a local DuckDB instance, comparing actual results against expected data defined in JSON files.

### Can I run Starlake unit tests in my CI pipeline?
Yes, since Starlake unit tests run on DuckDB locally, they can be executed in any CI environment without needing a service account or access to the target data warehouse. This makes them ideal for automated testing before deployment.

### What can I test with Starlake unit tests?
You can test both data loading and data transformations. For load tests, you provide sample input files and expected output data. For transform tests, you provide sample source data and verify the SQL transformation produces the expected results.
